#http://router_server/$db_name/$space_name
#url = "http://10.192.23.145:9001/multi_mode_mech_test/yw_data_p1/_search"
#adid='tt-8086'
#url = "http://10.102.23.108:9001/test_region05/space_region05/{}".format(adid)
adid="V070000ucms_7uQxMbuI2qj"
url = "http://10.192.23.145:9001/content_platform_db/sl_faiss/{}".format(adid)
feature=[-0.19670714,-1.1625068,-0.38811213,1.9133997,-1.549874,3.4320579,-5.713872,0.15828456,5.2362437,3.2590833,-1.8657472,-2.4952815,-0.3181587,-2.1064336,-1.7600745,1.6561557,-0.09330439,1.5287765,6.420225,-1.3157543,-2.9249945,1.0002813,-6.260759,-1.1102327,-3.0096684,-4.7369857,0.32120603,-7.326292,6.3099647,4.880537,5.793811,-0.941578,3.0119896,-7.517465,-9.991747,-6.371829,-2.4265482,-2.3231752,-0.86142164,-6.452339,-2.6545343,-2.0043948,-1.8514342,1.4115179,6.8672023,-1.1208316,2.5621078,3.588131,-4.3838325,0.48774198,-1.6056961,7.034452,1.9332078,1.7517483,-2.9490566,-2.3507197,3.5940297,-5.1526465,-3.9077625,-3.736541,8.132529,-0.33458224,3.4252477,3.872096,4.137376,2.0102546,-3.286394,-6.4691644,3.55862,5.3732414,0.77496535,-1.2961662,-2.9118733,-0.37477547,-3.459334,-0.65541893,0.7527768,-1.6285849,4.174228,0.5296811,2.690181,-4.895838,5.0509877,0.72234225,-1.5996537,-1.7665408,-5.1589155,-4.0882196,1.7609489,-3.2867987,-0.44403377,0.43862963,2.341124,-5.267336,-0.91624594,-6.3776097,4.904617,2.6414437,3.3091762,-2.7036607,-0.016657107,4.031546,-1.1599643,3.6919646,-1.3944004,-5.653618,-1.1697612,2.692808,8.357034,1.4517771,-3.9670627,0.76399374,3.7579496,5.42451,-3.332377,-6.2949877,4.072422,-2.2894979,-1.1871698,-0.7221805,-2.6070194,-2.550864,-1.5468053,1.2317691,5.368743,0.63325244,-2.2858388,1.846404]
body={"adid":adid,"vector":{"feature":feature}}
response = requests.post(url, headers={"content-type": "application/json"}, data=json.dumps(body))
resault = json.loads(response.text)
l_a = resault.keys()

#"adid": "haokan_5713"
#body = {"query": {"sum": [{"field": "vector","feature": [-0.19670714,-1.1625068,-0.38811213,1.9133997,-1.549874,3.4320579,-5.713872,0.15828456,5.2362437,3.2590833,-1.8657472,-2.4952815,-0.3181587,-2.1064336,-1.7600745,1.6561557,-0.09330439,1.5287765,6.420225,-1.3157543,-2.9249945,1.0002813,-6.260759,-1.1102327,-3.0096684,-4.7369857,0.32120603,-7.326292,6.3099647,4.880537,5.793811,-0.941578,3.0119896,-7.517465,-9.991747,-6.371829,-2.4265482,-2.3231752,-0.86142164,-6.452339,-2.6545343,-2.0043948,-1.8514342,1.4115179,6.8672023,-1.1208316,2.5621078,3.588131,-4.3838325,0.48774198,-1.6056961,7.034452,1.9332078,1.7517483,-2.9490566,-2.3507197,3.5940297,-5.1526465,-3.9077625,-3.736541,8.132529,-0.33458224,3.4252477,3.872096,4.137376,2.0102546,-3.286394,-6.4691644,3.55862,5.3732414,0.77496535,-1.2961662,-2.9118733,-0.37477547,-3.459334,-0.65541893,0.7527768,-1.6285849,4.174228,0.5296811,2.690181,-4.895838,5.0509877,0.72234225,-1.5996537,-1.7665408,-5.1589155,-4.0882196,1.7609489,-3.2867987,-0.44403377,0.43862963,2.341124,-5.267336,-0.91624594,-6.3776097,4.904617,2.6414437,3.3091762,-2.7036607,-0.016657107,4.031546,-1.1599643,3.6919646,-1.3944004,-5.653618,-1.1697612,2.692808,8.357034,1.4517771,-3.9670627,0.76399374,3.7579496,5.42451,-3.332377,-6.2949877,4.072422,-2.2894979,-1.1871698,-0.7221805,-2.6070194,-2.550864,-1.5468053,1.2317691,5.368743,0.63325244,-2.2858388,1.846404] }]},"direct_search_type": 0,"quick": False,"vector_value": False,"online_log_level": "debug","size": 10}

adid_vector=adids_vectors[0].split("\t")
adid = adid_vector[0]
vector_str = adid_vector[1]
vector_list_str = vector_str.split(',')
vector = []
for i in vector_list_str:
    vector.append(float(i))
url = "http://10.102.23.107:9001/multi_mode_mech_test/recall_alg_p2/{}".format(adid)
body = {'adid': adid, "vector": {"feature": vector}}
response = requests.post(url, headers={"content-type": "application/json"}, data=json.dumps(body))
print(response.text)